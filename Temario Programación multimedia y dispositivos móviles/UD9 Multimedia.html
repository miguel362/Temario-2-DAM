<!DOCTYPE html>
<!-- saved from url=(0070)https://sdram58.github.io/apuntesPMDM/unidades2223/ud9_multimedia.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UD9 Multimedia</title>
    <link rel="shortcut icon" type="image/x-icon" href="https://sdram58.github.io/apuntesPMDM/favicon.ico">
    <link rel="stylesheet" href="./UD9 Multimedia_files/prism.css">
    <link rel="stylesheet" href="./UD9 Multimedia_files/styles.css">
    <script src="./UD9 Multimedia_files/script.js.descarga"></script>
</head>
<body class="line-numbers">
    <h1>UD9 Multimedia</h1>
    <div class="main-menu">
        <div class="fila">
            <a href="https://sdram58.github.io/apuntesPMDM/unidades2223/ud9_multimedia.html#sAudioVideo">Audio and Video</a><a href="https://sdram58.github.io/apuntesPMDM/unidades2223/ud9_multimedia.html#sCamera">Camera</a><a href="https://sdram58.github.io/apuntesPMDM/unidades2223/ud9_multimedia.html#sAnimations">Animations</a>
        </div>
        <div class="fila"><a href="https://sdram58.github.io/apuntesPMDM/unidades2223/ud9_multimedia.html#sMaps">Maps</a><a href="https://sdram58.github.io/apuntesPMDM/unidades2223/ud9_multimedia.html#sPractice">Practice</a><a href="https://sdram58.github.io/apuntesPMDM/unidades2223/ud9_multimedia.html#sWebgraphy">Webgraphy</a></div>
        
    </div>

    



    <!--*********************************************************Audio and Video***********************************************************-->
    <section class="apartado">
    <a name="sAudioVideo"></a>
    <h2>Audio and Video</h2>
    <p>The Android multimedia framework includes support for playing variety of common media types, so that you can easily integrate audio, video and images 
        into your applications. You can play audio or video from media files stored in your application's resources(raw resources), 
        from standalone files in the filesystem, or from a data stream arriving over a network connection, all using <span class="r-word">MediaPlayer</span>  APIs.</p>
    
    <p>The following classes are used to play sound and video in the Android framework:</p>
    <ul>
        <li><span class="r-word">MediaPlayer</span> 
            <ul>
                <li>This class is the primary API for playing sound and video.</li>
            </ul>
        </li>
        <li><span class="r-word">AudioManager</span> 
            <ul>
                <li>This class manages audio sources and audio output on a device.</li>
            </ul>
        </li>
    </ul>


    <p class="sub-section">Permissions</p>
    <p>Before starting development on your application using MediaPlayer, make sure your manifest has the appropriate declarations to allow use of related features on the <span class="inline-file">Manifest.xml</span>.
        </p><ul>
            <li> <span class="negrita">Internet Permission </span>- If you are using MediaPlayer to stream network-based content, your application must request network access.</li>
            <section><div class="code-toolbar"><pre class="language-xml line-numbers" tabindex="0"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>android.permission.INTERNET<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
            </section><br><br>
            <li><span class="negrita">Wake Lock Permission</span>  - If your player application needs to keep the screen from dimming or the processor from sleeping, or uses the 
                <span class="r-word">MediaPlayer.setScreenOnWhilePlaying()</span>  or <span class="r-word">MediaPlayer.setWakeMode()</span>  methods, you must request this permission.
            <section><div class="code-toolbar"><pre class="language-xml line-numbers" tabindex="0"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>android.permission.WAKE_LOCK<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
            </section><br><br></li>
        </ul>
<p></p>
    
    
    <h3>Audio</h3>
    <p>We will use <span class="r-word">MediaPlayer</span>  class for play our audios</p>
    <p>In this section we're going to implement a basic audio player with 3 buttons <span class="cursiva">play</span> , <span class="cursiva">pause</span>  and <span class="cursiva">stop</span> 
         like you can see in the image below.</p>
        
    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-10-12-40-23.png"><br><figcaption></figcaption></figure>
    <br>

    <p>The first thing we are going to do is create the <span class="inline-folder">raw</span> directory inside <span class="inline-folder">res</span> and save the audio or audios that we want to play. 
        In our case you can download it from  <a class="enlace" target="_blank" href="https://sdram58.github.io/apuntesPMDM/unidades2223/UD9/assets/bola_drac_intro.mp3">here</a>.</p>
    

    <p>To continue, we create the layout of the <span class="d-word">MainActivity</span> </p>
    

    <section class="marco-t file-">
        <span class="icono file"> </span> <span class="negrita">activity_main.xml</span>
        </section>
    <section class="marco-b">
<section><div class="code-toolbar"><pre class="language-xml line-numbers" tabindex="0"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RelativeLayout</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res/android<span class="token punctuation">"</span></span>
    <span class="token attr-name"><span class="token namespace">xmlns:</span>tools</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/tools<span class="token punctuation">"</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>
    <span class="token attr-name"><span class="token namespace">tools:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>.MainActivity<span class="token punctuation">"</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>padding</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>16dp<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>
        <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/textView<span class="token punctuation">"</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>MediaPlayer Demo<span class="token punctuation">"</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_centerHorizontal</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>textSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>32sp<span class="token punctuation">"</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>textColor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@android:color/holo_blue_dark<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>horizontal<span class="token punctuation">"</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_centerVertical</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span>
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/btnPlay<span class="token punctuation">"</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_weight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_margin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>5dp<span class="token punctuation">"</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Play<span class="token punctuation">"</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>music<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span>
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/btnPause<span class="token punctuation">"</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_weight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_margin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>5dp<span class="token punctuation">"</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Pause<span class="token punctuation">"</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>music<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span>
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/btnStop<span class="token punctuation">"</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_weight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_margin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>5dp<span class="token punctuation">"</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Stop<span class="token punctuation">"</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>music<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RelativeLayout</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
                </section>          
    </section>
    <p>As you can see, in this case the three buttons already have the <span class="d-word">onClick</span> event attached.</p>
      
    <section><div class="code-toolbar"><pre class="language-xml line-numbers" tabindex="0"><code class="language-xml">android:onClick="music"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br><br>

    <p>We create a variable of type <span class="r-word">MediaPlayer</span> that will be the one that controls the audio.</p>
    
    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-var">var</span> mediaPlayer<span class="token operator">:</span> MediaPlayer<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>

    <p>With this object we can:</p>
    <ul>
        <li>Create it and link it with an audio file.
            <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">mediaPlayer <span class="token operator">=</span> MediaPlayer<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> R<span class="token punctuation">.</span>raw<span class="token punctuation">.</span>ball_drac_intro<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
            </section>
        </li>
    
    
   
    <li>Start playback
    
        <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">mediaPlayer<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section></li>
    <li>Pause playback
    
        <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">mediaPlayer<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section></li>
    <li>Stop playback
    
        <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">mediaPlayer<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section></li>
    <li>Release the media to free memory
    
        <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">mediaPlayer<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section></li>

    <li>We can add event handlers to it, for example for what to do when the playback ends.
    

        <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token comment">//Register OnCompletionListener that calls a user supplied callback method onCompletion() when</span>
    <span class="token comment">// looping mode was set to false to indicate playback is completed.</span>
    mediaPlayer<span class="token punctuation">.</span><span class="token function">setOnCompletionListener</span> <span class="token punctuation">{</span> <span class="token comment">// Here, call a method to release the MediaPlayer object and to set it to null.</span>
        <span class="token function">stopMusic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//or start again...</span>
    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section></li>

    </ul>
    <br><br>

    <p>I encourage you to investigate the other options of the MediaPlayer class.</p> <br>
    
    
    <p>The complete code of MainActivity could look like this.</p>

    <section class="marco-t file-">
        <span class="icono file"> </span> <span class="negrita">MainActivity</span>
        </section>
    <section class="marco-b">
        <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-class">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-lateinit">lateinit</span> <span class="token keyword keyword-var">var</span> binding<span class="token operator">:</span> ActivityMainBinding
    <span class="token keyword keyword-var">var</span> mediaPlayer<span class="token operator">:</span> MediaPlayer<span class="token operator">?</span> <span class="token operator">=</span><span class="token keyword keyword-null">null</span>

    <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-super">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>ActivityMainBinding<span class="token punctuation">.</span><span class="token function">inflate</span><span class="token punctuation">(</span>layoutInflater<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">also</span> <span class="token punctuation">{</span> binding <span class="token operator">=</span> it <span class="token punctuation">}</span><span class="token punctuation">.</span>root<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-fun">fun</span> <span class="token function">music</span><span class="token punctuation">(</span>view<span class="token operator">:</span> View<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-when">when</span> <span class="token punctuation">(</span>view<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>btnPlay <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token comment">// Check if mediaPlayer is null. If true, we'll instantiate the MediaPlayer object</span>
                <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>mediaPlayer <span class="token operator">==</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    mediaPlayer <span class="token operator">=</span> MediaPlayer<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> R<span class="token punctuation">.</span>raw<span class="token punctuation">.</span>drac_ball_intro<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
                <span class="token comment">// Then, register OnCompletionListener that calls a user supplied callback method onCompletion() when</span>
                <span class="token comment">// looping mode was set to false to indicate playback is completed.</span>
                mediaPlayer<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">setOnCompletionListener</span> <span class="token punctuation">{</span> <span class="token comment">// Here, call a method to release the MediaPlayer object and to set it to null.</span>
                    <span class="token function">stopMusic</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
                <span class="token comment">// Next, call start() method on mediaPlayer to start playing the music.</span>

                mediaPlayer<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>btnPause <span class="token operator">-&gt;</span> <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>mediaPlayer <span class="token operator">!=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// Here, call pause() method on mediaPlayer to pause the music.</span>
                mediaPlayer<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>btnStop <span class="token operator">-&gt;</span> <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>mediaPlayer <span class="token operator">!=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// Here, call stop() method on mediaPlayer to stop the music.</span>
                mediaPlayer<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">// Call stopMusic() method</span>
                <span class="token function">stopMusic</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-private">private</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">stopMusic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mediaPlayer<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        mediaPlayer <span class="token operator">=</span> <span class="token keyword keyword-null">null</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Call stopMusic() in onStop() overridden method as well.</span>
    <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onStop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-super">super</span><span class="token punctuation">.</span><span class="token function">onStop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">stopMusic</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
            </section>     
    </section>
    
    <section class="marco-t warn">
        <span class="icono warning"> </span> We can use coroutines to emit in the background
        </section>
    <section class="marco-b">
            
    </section>
    
    
    <br><br>
    

    <a class="enlace" target="_blank" href="https://github.com/sdram58/EjemplosPMDM2223/tree/master/UD9/MediaPlayerExample">MediaPlayer Example</a> 
    
    
    <h3>Video</h3>

    <p>Please review the following commented examples. Implement them, modify them, change them, ultimately play with them.</p>
    
    <p class="sub-section">Play video from local resource</p>

    <p>We need a <span class="r-word">VideoView</span>  view</p>
    

    <section><div class="code-toolbar"><pre class="language-xml line-numbers" tabindex="0"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>VideoView</span>
    <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/vvVideo<span class="token punctuation">"</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>400dp<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>

    <p>We create a MediaController object to show us the play, pause, time, etc. buttons.</p>
     
    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-val">val</span> mediaController<span class="token operator">:</span>MediaController <span class="token keyword keyword-by">by</span> lazy <span class="token punctuation">{</span> <span class="token function">MediaController</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br><br>

    <p>We create the path to the local video </p>
    
    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-val">val</span> path <span class="token operator">=</span> <span class="token string">"android.resource://"</span> <span class="token operator">+</span> packageName <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> R<span class="token punctuation">.</span>raw<span class="token punctuation">.</span>drac_ball<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>

    <p>We anchor the controller to the view where they will be displayed.</p>
        
    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">mediaController<span class="token punctuation">.</span><span class="token function">setAnchorView</span><span class="token punctuation">(</span>binding<span class="token punctuation">.</span>vvVideo<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>

    <p>We bind the controller to the view</p>
    
    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">binding<span class="token punctuation">.</span>vvVideo<span class="token punctuation">.</span><span class="token function">setMediaController</span><span class="token punctuation">(</span>mediaController<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>

    <p>We indicate to the VideoView the path where the resource is located</p>
    
    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">binding<span class="token punctuation">.</span>vvVideo<span class="token punctuation">.</span><span class="token function">setVideoPath</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>

    <p>
        We indicate what to do when you are ready. This returns an object of type <span class="r-word">MediaPlayer</span> . 
        In this case, we tell it that activate the looping and that it starts as soon as it is ready.
    </p>
    
    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">binding<span class="token punctuation">.</span>vvVideo<span class="token punctuation">.</span><span class="token function">setOnPreparedListener</span> <span class="token punctuation">{</span> mp <span class="token operator">-&gt;</span>
    mp<span class="token punctuation">.</span>isLooping <span class="token operator">=</span> <span class="token boolean">true</span>
    mp<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>

    <p>We can also start reproducing the video from the VideoView methods.</p>
    
    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">binding<span class="token punctuation">.</span>vvVideo<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br><br>


    <a class="enlace" target="_blank" href="https://github.com/sdram58/EjemplosPMDM2223/tree/master/UD9/VideoFromLocal">Play video from Raw resource</a> 
    
    <p class="sub-section">Play video from url</p>

    <p>The first thing we need to do is give the app Internet permissions in the <span class="inline-file">AndroidManifest.xml</span></p>
     

    <section><div class="code-toolbar"><pre class="language-xml line-numbers" tabindex="0"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>android.permission.INTERNET<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>

    <p>We add the VideoView view to our layout</p>
    
    <section><div class="code-toolbar"><pre class="language-xml line-numbers" tabindex="0"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>VideoView</span>
    <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/vvVideo<span class="token punctuation">"</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>400dp<span class="token punctuation">"</span></span>
    <span class="token attr-name"><span class="token namespace">app:</span>layout_constraintBottom_toBottomOf</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>parent<span class="token punctuation">"</span></span>
    <span class="token attr-name"><span class="token namespace">app:</span>layout_constraintEnd_toEndOf</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>parent<span class="token punctuation">"</span></span>
    <span class="token attr-name"><span class="token namespace">app:</span>layout_constraintStart_toStartOf</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>parent<span class="token punctuation">"</span></span>
    <span class="token attr-name"><span class="token namespace">app:</span>layout_constraintTop_toTopOf</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>parent<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>

    <p>We're going to playback the video allocated <a class="enlace" target="_blank" href="https://sdram58.github.io/apuntesPMDM/unidades2223/UD9/assets/bola_drac.mp4">here</a>.</p>

    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-val">val</span> urlVideo <span class="token operator">=</span> <span class="token string">"https://sdram58.github.io/apuntesPMDM/unidades2223/UD9/assets/bola_drac.mp4"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>

    <p>We parse the url</p>
    
    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-val">val</span> uri<span class="token operator">:</span> Uri <span class="token operator">=</span> Uri<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>urlVideo<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>

    <p>We add the URIs to the VideoView.</p>
    
    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token function">setVideoURI</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>

    <p>We use the properties and methods that we have used before, looking like that</p>
    
    .
    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token function">with</span><span class="token punctuation">(</span>binding<span class="token punctuation">.</span>vvVideo<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">setMediaController</span><span class="token punctuation">(</span><span class="token function">MediaController</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token label symbol">@MainActivity</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token function">setVideoURI</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span>
    <span class="token function">requestFocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    setOnPreparedListener <span class="token punctuation">{</span> mp <span class="token operator">-&gt;</span>
        mp<span class="token punctuation">.</span>isLooping <span class="token operator">=</span> <span class="token boolean">true</span>
        binding<span class="token punctuation">.</span>vvVideo<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br><br>

    <a class="enlace" target="_blank" href="https://github.com/sdram58/EjemplosPMDM2223/tree/master/UD9/VideoFromInternet">Play video from Internet URL</a> 
    
    <p class="sub-section">Play youtube video</p>

    <p>In this section we will use a little workaround to get videos from youtube without using its own API. For it:</p>
    

    <p>We will use <span class="r-word">WebView</span>  views, which will be the elements of the RecyclerView.</p>
    

    <section><div class="code-toolbar"><pre class="language-xml line-numbers" tabindex="0"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>WebView</span>
    <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/wvVideo<span class="token punctuation">"</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>180dp<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br>

    <p>Let's create the html iframe that will contain embedded youtube videos.</p>
    

    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token operator">%</span>lt<span class="token punctuation">;</span>iframe width<span class="token operator">=</span><span class="token string">"100%"</span> height<span class="token operator">=</span><span class="token string">"100%"</span> src<span class="token operator">=</span><span class="token string">"https://www.youtube.com/embed/eWEF1Zrmdow"</span> frameborder<span class="token operator">=</span><span class="token string">"0"</span> allowfullscreen<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>iframe<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>

    <p>We create several and add them to the adapter list of the RecyclerView</p>
    

    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"> youtubeVideos<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">YouTubeVideos</span><span class="token punctuation">(</span><span class="token string">"&lt;iframe width=\"100%\" height=\"100%\" src=\"https://www.youtube.com/embed/eWEF1Zrmdow\" frameborder=\"0\" allowfullscreen&gt;&lt;/iframe&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
youtubeVideos<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">YouTubeVideos</span><span class="token punctuation">(</span><span class="token string">"&lt;iframe width=\"100%\" height=\"100%\" src=\"https://www.youtube.com/embed/KyJ71G2UxTQ\" frameborder=\"0\" allowfullscreen&gt;&lt;/iframe&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
youtubeVideos<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">YouTubeVideos</span><span class="token punctuation">(</span><span class="token string">"&lt;iframe width=\"100%\" height=\"100%\" src=\"https://www.youtube.com/embed/y8Rr39jKFKU\" frameborder=\"0\" allowfullscreen&gt;&lt;/iframe&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
youtubeVideos<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">YouTubeVideos</span><span class="token punctuation">(</span><span class="token string">"&lt;iframe width=\"100%\" height=\"100%\" src=\"https://www.youtube.com/embed/8Hg1tqIwIfI\" frameborder=\"0\" allowfullscreen&gt;&lt;/iframe&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
youtubeVideos<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">YouTubeVideos</span><span class="token punctuation">(</span><span class="token string">"&lt;iframe width=\"100%\" height=\"100%\" src=\"https://www.youtube.com/embed/uhQ7mh_o_cM\" frameborder=\"0\" allowfullscreen&gt;&lt;/iframe&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>

<p>We add them in adapter to each WebView</p>

<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">holder<span class="token punctuation">.</span>videoWeb<span class="token punctuation">.</span><span class="token function">loadData</span><span class="token punctuation">(</span>youtubeVideoList<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span>videoUrl<span class="token operator">?:</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"text/html"</span> <span class="token punctuation">,</span> <span class="token string">"utf-8"</span> <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br>

Debemos también habilitar javascript de cada webview y añadir quien será el cliente.

<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">videoWeb<span class="token punctuation">.</span><span class="token function">getSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setJavaScriptEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
videoWeb<span class="token punctuation">.</span><span class="token function">setWebChromeClient</span><span class="token punctuation">(</span><span class="token keyword keyword-object">object</span> <span class="token operator">:</span> <span class="token function">WebChromeClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>



    <a class="enlace" target="_blank" href="https://github.com/sdram58/EjemplosPMDM2223/tree/master/UD9/YotubeWithoutAPI">Play youtube video without its API</a> 
     <br><br><br>
    
    <div class="tarea">Exercise. Create an audio or video player with your own buttons. You will have to play 4 or 5 audios / videos. We will have a button to:
        <ul>
            <li>Play/Pause: It will start or pause the playback according to the case.</li>
            <li>Stop: for reproduction</li>
            <li>Track ahead: Go to the next track if there is more</li>
            <li>Track back: Move to the previous track if it is not the first</li>
            <li>Fast Forward: Fast forward 10 seconds, if it remains more than 10sec, the track</li>
            <li>Fast Rewind: Rewinds 10 seconds, if there are less than 10 seconds it goes to the beginning.</li>
            <li>Seek bar: It will indicate at all moment, the progress of the audio or video being 0 the begining of the track and max its duration. 
                If we change seek bar's position the audio or video will seek to this position.</li>
        </ul>
    </div> 
    </section><!-- End section -->

    <!--*********************************************************Camera***********************************************************-->
    <section class="apartado">
        <a name="sCamera"></a>
        <h2>Camera</h2>

        <h3>Camera X</h3>

        <p>We're going to use <span class="r-word">CameraX</span>. <span class="r-word">CameraX</span>  is a <span class="negrita">Jetpack</span> 
            support library, built to help you make camera app development <span class="cursiva">"easier"</span>.
            It provides a consistent and <span class="subrayado">easy-to-use API surface</span> that works across most Android devices, with backward-compatibility to Android 5.0(API level 21).</p>

        
        <p>Follow the next <a class="enlace" target="_blank" href="https://developer.android.com/codelabs/camerax-getting-started#0">link</a>  and do and study the codelab about camerax</p>

        <p><a class="enlace" target="_blank" href="https://github.com/sdram58/EjemplosPMDM2223/tree/master/UD9/CameraX">Here</a> you have the complete code</p>
        
            



        <h3>Scanning barcodes</h3>
        
        <p>You can use this QR for testing you app</p>
        <figure><img src="./UD9 Multimedia_files/ud9-2022-01-11-01-52-03.png"><br><figcaption></figcaption></figure>
        <br>

        <p><a class="enlace" target="_blank" href="https://github.com/yuriy-budiyev/code-scanner">Here </a>  is the dependency documentation on github</p>

        <p>To begin we will add the dependency in our <span class="inline-file">module:app</span> of the gradle.</p>
        
        <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">implementation <span class="token string">'com.github.yuriy-budiyev:code-scanner:2.3.2'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section><br>

        <p>In order for it to find this dependency, we must tell it where to look for it. To do this, in the <span class="inline-file">settings.graddle</span>
             file we add the repository.</p>
        

        <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">dependencyResolutionManagement <span class="token punctuation">{</span>

    repositories <span class="token punctuation">{</span>
        <span class="token operator">..</span><span class="token operator">..</span><span class="token operator">..</span><span class="token punctuation">.</span>
        <span class="token comment">//Add this line</span>
        maven <span class="token punctuation">{</span> url <span class="token string">'https://jitpack.io'</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section><br>

        <p>Since we are going to use the camera we must give it permissions to use it in the <span class="inline-file">AndroidManifest.xml</span></p>
        

        <section><div class="code-toolbar"><pre class="language-xml line-numbers" tabindex="0"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>android.permission.CAMERA<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section><br>

        <p>Don't forget about dynamic permissions on API &gt;= 23</p>
        
        <p>To do this we check if we have CAMERA permission.</p>
        
        <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-val">val</span> permission<span class="token operator">:</span> Int <span class="token operator">=</span> ContextCompat<span class="token punctuation">.</span><span class="token function">checkSelfPermission</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span>
    android<span class="token punctuation">.</span>Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>CAMERA<span class="token punctuation">)</span>

<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>permission <span class="token operator">!=</span> PackageManager<span class="token punctuation">.</span>PERMISSION_GRANTED<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">requestPermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section><br>

        <p>As we can see, if we do not have camera permission, we ask for it.</p>
        

    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">ActivityCompat<span class="token punctuation">.</span><span class="token function">requestPermissions</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span>
    <span class="token function">arrayOf</span><span class="token punctuation">(</span>android<span class="token punctuation">.</span>Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>CAMERA<span class="token punctuation">)</span><span class="token punctuation">,</span>
    CAMERA_REQUEST_CODE<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>

    <p>We check if the user has granted us the permissions. If not, we show user a message. To do this we override <span class="r-word">onRequestPermissionsResult</span> </p>
    

    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onRequestPermissionsResult</span><span class="token punctuation">(</span>
        requestCode<span class="token operator">:</span> Int<span class="token punctuation">,</span>
        permissions<span class="token operator">:</span> Array<span class="token punctuation">,</span>
        grantResults<span class="token operator">:</span> IntArray
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-super">super</span><span class="token punctuation">.</span><span class="token function">onRequestPermissionsResult</span><span class="token punctuation">(</span>requestCode<span class="token punctuation">,</span> permissions<span class="token punctuation">,</span> grantResults<span class="token punctuation">)</span>
        <span class="token keyword keyword-when">when</span><span class="token punctuation">(</span>requestCode<span class="token punctuation">)</span><span class="token punctuation">{</span>
            CAMERA_REQUEST_CODE <span class="token operator">-&gt;</span><span class="token punctuation">{</span>
                <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>grantResults<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> grantResults<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">!=</span> PackageManager<span class="token punctuation">.</span>PERMISSION_GRANTED<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> <span class="token string">"You need the camera permission if you want use the app"</span><span class="token punctuation">,</span> Toast<span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token keyword keyword-else">else</span><span class="token punctuation">{</span>
                    <span class="token comment">//Success</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>

    <section class="marco-t warn">
        <span class="icono warning"> </span> Note that we must create the permission request code.
        </section>
    <section class="marco-b">
            <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-private">private</span> <span class="token keyword keyword-const">const</span> <span class="token keyword keyword-val">val</span> CAMERA_REQUEST_CODE <span class="token operator">=</span> <span class="token number">110</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
            </section>
    </section>

    <p>We add in the layout the view of type <span class="d-word">com.budiyev.android.codescanner.CodeScannerView</span> where we want.</p>
    
    <section><div class="code-toolbar"><pre class="language-xml line-numbers" tabindex="0"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>com.budiyev.android.codescanner.CodeScannerView</span>
        <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/scanner_view<span class="token punctuation">"</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>

    <p>We can also use the following properties:</p>    

<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">maskColor
maskVisible
frameColor
frameVisible
frameThickness
frameCornersSize
frameCornersRadius
frameCornersCapRounded
frameAspectRatioWidth
frameAspectRatioHeight
frameSize
frameVerticalBias
autoFocusButtonColor
autoFocusButtonVisible
autoFocusButtonPaddingHorizontal
autoFocusButtonPaddingVertical
autoFocusButtonOnIcon
autoFocusButtonOffIcon
autoFocusButtonPosition
flashButtonColor
flashButtonVisible
flashButtonPaddingHorizontal
flashButtonPaddingVertical
flashButtonOnIcon
flashButtonOffIcon
flashButtonPosition<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br>
        
    
<p>We create an instance of <span class="r-word">CodeScannerView</span> </p>


<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">codeScanner <span class="token operator">=</span> <span class="token function">CodeScanner</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> scannerView<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br>

<p>We can initialize some of the above parameters by code. In this case we put them to their default values. Find out more about these options.</p>

<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token comment">// Parameters (default values)</span>
codeScanner<span class="token punctuation">.</span>camera <span class="token operator">=</span> CodeScanner<span class="token punctuation">.</span>CAMERA_BACK <span class="token comment">// or CAMERA_FRONT or specific camera id</span>
codeScanner<span class="token punctuation">.</span>formats <span class="token operator">=</span> CodeScanner<span class="token punctuation">.</span>ALL_FORMATS <span class="token comment">// list of type BarcodeFormat,</span>
<span class="token comment">// ex. listOf(BarcodeFormat.QR_CODE)</span>
codeScanner<span class="token punctuation">.</span>autoFocusMode <span class="token operator">=</span> AutoFocusMode<span class="token punctuation">.</span>SAFE <span class="token comment">// or CONTINUOUS</span>
codeScanner<span class="token punctuation">.</span>scanMode <span class="token operator">=</span> ScanMode<span class="token punctuation">.</span>SINGLE <span class="token comment">// or CONTINUOUS or PREVIEW</span>
codeScanner<span class="token punctuation">.</span>isAutoFocusEnabled <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token comment">// Whether to enable auto focus or not</span>
codeScanner<span class="token punctuation">.</span>isFlashEnabled <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token comment">// Whether to enable flash or not</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br>

<p>We create the callbacks that will get the decoding text or an error if the camera could not be opened.</p>


<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token comment">// Callbacks</span>
codeScanner<span class="token punctuation">.</span>decodeCallback <span class="token operator">=</span> DecodeCallback <span class="token punctuation">{</span>
    runOnUiThread <span class="token punctuation">{</span>
        Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> <span class="token string">"Scan result: <span class="token interpolation"><span class="token delimiter variable">${</span>it<span class="token punctuation">.</span>text<span class="token delimiter variable">}</span></span>"</span><span class="token punctuation">,</span> Toast<span class="token punctuation">.</span>LENGTH_LONG<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
codeScanner<span class="token punctuation">.</span>errorCallback <span class="token operator">=</span> ErrorCallback <span class="token punctuation">{</span> <span class="token comment">// or ErrorCallback.SUPPRESS</span>
    runOnUiThread <span class="token punctuation">{</span>
        Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> <span class="token string">"Camera initialization error: <span class="token interpolation"><span class="token delimiter variable">${</span>it<span class="token punctuation">.</span>message<span class="token delimiter variable">}</span></span>"</span><span class="token punctuation">,</span>
            Toast<span class="token punctuation">.</span>LENGTH_LONG<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br>

<p>We initialize the preview.</p>

<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">scannerView<span class="token punctuation">.</span><span class="token function">setOnClickListener</span> <span class="token punctuation">{</span>
            codeScanner<span class="token punctuation">.</span><span class="token function">startPreview</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br>

        


        
        
        
        <p><a class="enlace" target="_blank" href="https://github.com/sdram58/EjemplosPMDM2223/tree/master/UD9/QR_Reader">QR and barcode reader example</a> </p>
        
        
        </section><!-- End section -->

    <!--*********************************************************Animations***********************************************************-->
    <section class="apartado">
    <a name="sAnimations"></a>
    <h2>Animations</h2>

<!------------------------------------------    <h3>Automatic animations</h3>

    <h3>Drawable animations</h3>

    <h3>Crossfade animation</h3>

    <h3>Transitions between Activities</h3>------------------------------------------------->


    <h3>Lottie animations</h3>

    <p>Lottie is an open source animation file format that's tiny, high quality, interactive, and can be manipulated at runtime.</p>
    
    <p>You have to get a <span class="negrita">json</span> file and save it into <span class="inline-folder">asset dir</span>  or <span class="inline-folder">raw dir</span> <br>
    You can get it from <a class="enlace" target="_blank" href="https://lottiefiles.com/">https://lottiefiles.com/</a>. Here there are a lot of animations and many of them are free. 

    You can choose the one you want to download the <span class="negrita">json file</span> and leave it in the <span class="inline-folder">assets</span> or <span class="inline-folder">raw</span> directory of your application
</p>
    

    <p>You need to add Lottie's dependency in the <span class="inline-file">gradle:app</span></p>
    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">def lottieVersion <span class="token operator">=</span> <span class="token string">"5.2.0"</span>
implementation <span class="token string">"com.airbnb.android:lottie:<span class="token interpolation variable">$lottieVersion</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>

    <section class="marco-t inf">
        <span class="icono info"> </span> You can see the latest version <a class="enlace" target="_blank" href="https://github.com/airbnb/lottie-android">here</a> 
        </section>
    <section class="marco-b">
            
    </section>

    <p>Open the app, run it, read the comments and try to play it.</p>
    
        

    <a class="enlace" target="_blank" href="https://github.com/sdram58/PMDM2021/tree/master/LottieAnimations">Lottie Animations Example</a> 
    
    <!------------------------------------------<h3>Shared element animations</h3>------------------------------------------------->
    
    <br><br><br>
    <div class="tarea">
        <span class="negrita">Exercise</span>: Starting from the cameraX application, save it to disk and when taking a new photo and if everything goes well, a Lottie animation will be played.
        Find and choose an animation that you want. <br>
        In addition, in your Activity will have a button and an ImageView. By clicking on the button you will see the photo saved in the ImageView.
        To achieve this you can use <span class="negrita">BitmapDescriptory.decodeFile(pathName: String)</span> with returns you a Bitmap that you can use in the ImageView
    </div>
    
    </section><!-- End section -->

    <!--*********************************************************Maps***********************************************************-->
    <section class="apartado">
    <a name="sMaps"></a>
    <h2>Maps</h2>

    <h3>Introduction</h3>

    <p>We are going to start working with the <span class="r-word">Google Maps API</span>, we can work with this API without using real-time location, 
        for example, for an App that simply shows places of interest, we could even calculate the distance between them, makes it clear that what is “beautiful” is App's that 
        integrate said location. Consequently, first of all, comment that there are basically two ways to acquire location data, 
        the <span class="negrita">obsolete</span>  but <span class="negrita">simple</span>  <span class="d-word"> android.location</span>, and the <span class="d-word">Google Location Services API</span>. 
        The first is not recommended by even Google, as can be seen in the following screenshot.</p>
    

    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-11-25-17.png"><br><figcaption></figcaption></figure>
    <br>
        
    <p>We will then use the second, for which we will require <span class="negrita">Google Play Services</span>, 
        which is a huge set of common services or utilities, including location</p>
    
     <p>Therefore, it installs in the Android Studio <span class="negrita">Google Play Services</span>. Go to <span class="negrita">Tools&gt; SDK Manager&gt; Android SDK menu&gt;</span> 
<span class="negrita">SDK Tools</span>  tab, select the <span class="subrayado">Google Play Services</span>  CheckBox and OK.</p>        
    

    
    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-11-20-46-33.png"><br><figcaption>Adding Google Play services</figcaption></figure>
    <br>


    <!------------------------------------------ Google Maps API ------------------------------------------------->
    <h3> Google Maps API </h3>

    <p>We are going to study the following points practicing at the same time, therefore it is recommended to try each one of them. 
        Create a App choosing Google Maps Activity as a template, we call it myMaps. We use Kotlin and leave the minimum API at 23 
      (it will NOT work on versions lower than Android 6 Marshmallow), not legacy. 
        The reason for using this version is that, from this API, to use the localization and other services, 
        it is required to ask for permissions at runtime, we will see what this means later</p>

    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-11-31-54.png"><br><figcaption>Google Maps Activity</figcaption></figure>
    <br>
    
    <p>If we now run the App on our real device, although the App opens, we will see that it does not work and that the screen <span class="subrayado">appears blank</span>. 
        This is because we have not yet incorporated an <span class="d-word">API KEY</span> to the project to use the <span class="negrita">Google Maps API</span>.
        This, we must insert it into a <span class="negrita">meta-data tag</span>  in the <span class="inline-file">AndroidManifest.xml</span>, as seen below, it is already prepared.</p>
    
<figure><img src="./UD9 Multimedia_files/ud9-2023-01-23-12-19-22.png"><br><figcaption>AndroidManifest.xml meta-data </figcaption></figure>
<br>



<p>On the other hand, we must make the <span class="negrita">android:value</span>  attribute point to a variable created in our <span class="inline-file">local.properties</span>
     file and create a variable there, the variable name would be for example <span class="d-word">MAPS_API_KEY</span>. Then use this variable from the <span class="inline-file">AndroidManifest</span> using
     <span class="d-word">"${MAPS_API_KEY}"</span> </p>
    
    <section class="marco-t file-">
        <span class="icono file"> </span> <span class="negrita">local.properties</span>
        </section>
    <section class="marco-b">
        <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">sdk<span class="token punctuation">.</span>dir<span class="token operator">=</span>C\<span class="token operator">:</span>\\Users\\username\\AppData\\Local\\Android\\Sdk
MAPS_API_KEY<span class="token operator">=</span>Aiza<span class="token operator">..</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>
    </section>

    <section class="marco-t warn">
        <span class="icono warning"> </span>Notice that we don't know the value of the MAPS_API_KEY variable yet.
        </section>
    <section class="marco-b">
            
    </section>


    <section class="marco-t file-">
        <span class="icono file"> </span> <span class="negrita">AndroidManifest.xml</span>
        </section>
    <section class="marco-b">
            <section><div class="code-toolbar"><pre class="language-xml line-numbers" tabindex="0"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta-data</span>
    <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.google.android.geo.API_KEY<span class="token punctuation">"</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>${MAPS_API_KEY}<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
            </section><br><br>
    </section>
     

         
    <p>To get this <span class="negrita">KEY</span>, we will need two things: </p><ul>
        <li>One is the <span class="d-word">package name</span>(which we know)</li>
        <li>The other is the unique <span class="d-word">signature key</span> (SHA-1 fingerprint) that Google gives to each Android developer, we have already consulted the default signature,
            and that is the one that we are going to use since the template has been prepared for it</li>
    </ul>
        <br>In <a class="enlace" target="_blank" href="https://developers.google.com/maps/documentation/android-sdk/get-api-key">https://developers.google.com/maps/documentation/android-sdk/get-api-key</a>
        we have more information for getting the API_KEY.<p></p> <br>


    <p>To obtain our SHA-1 fingerprint, we can also access it through the gradle option located to the right of Android Studio by 
        executing <span class="negrita">gradle signingReport</span>. You can also use AS terminal with the same command.</p>
    
    <figure><img src="./UD9 Multimedia_files/UD9_getting_sha1.gif"><br><figcaption></figcaption></figure>
    <br>
    
     
    <section class="marco-t warn">
        <span class="icono warning"> </span> Remember to add gradle to the pathName if you haven't done so before
        </section>
    <section class="marco-b">
            
    </section>
    


    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-18-11-23-19.png"><br><figcaption></figcaption></figure>
    <br>
    
    
    <p>Now that we have the two things we need, <span class="d-word">PACKAGENAME</span>  and <span class="d-word">SHA-1 fingerprint</span> .
        We are going to register the new <span class="d-word">API_KEY</span> for our project.</p>
    

    <p>For this we go to the following link: 
        <a class="enlace" target="_blank" href="https://developers.google.com/maps/documentation/android-sdk/get-api-key">https://developers.google.com/maps/documentation/android-sdk/get-api-key</a> </p>

    <p>We enter the credentials page.</p>
    
    <figure><img src="./UD9 Multimedia_files/ud9-2023-01-23-13-21-34.png"><br><figcaption></figcaption></figure>
    <br>
    
    
    <section class="marco-t warn">
        <span class="icono warning"> </span> Be careful, you must have a Google Cloud console account.
        </section>
    <section class="marco-b">
            
    </section>

    <section class="marco-t warn">
        <span class="icono warning"> </span> Now, Google cloud requires a billing account.
        </section>
    <section class="marco-b">
            
    </section>
    
    

    <p>Through the URL we access the console where we will have to <span class="cursiva">select</span>  or <span class="cursiva">create a new</span>  project. 
        In our case it will be to create a one.</p>

        <section class="marco-t warn">
            <span class="icono warning"> </span> May be the following steps are modified but practically it is the same.
            </section>
        <section class="marco-b">
                
        </section>
        
    
    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-11-23-10-56.png"><br><figcaption>Google console</figcaption></figure>
    <br>

    <p>We select a project.</p>    
    
    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-11-23-11-34.png"><br><figcaption>project</figcaption></figure>
    <br>

    <p>We choose the name of the project and the organization if we want to have it organized. And we give you to create the project</p>    
    
    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-11-23-13-22.png"><br><figcaption>Project Name</figcaption></figure>
    <br>

    <p>Once the project is created, we select it and click the next button</p>
    
    
    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-11-23-14-11.png"><br><figcaption>Select created project</figcaption></figure>
    <br>
    
    <p>Click on the enable button</p>    
    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-11-23-14-54.png"><br><figcaption>Enable Maps SDK</figcaption></figure>
    <br>

    <p>Click on the button to create the API KEY</p>
    
    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-11-23-15-54.png"><br><figcaption>Create API KEY</figcaption></figure>
    <br>

    <p>We already have the API Key created, now we must copy it into the <span class="negrita">google_maps_key</span>  field of the String tag in 
        <span class="inline-file">google_maps_api.xml</span> file</p>
    
        
    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-11-23-17-44.png"><br><figcaption>API KEY created</figcaption></figure>
    <br>

    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-11-57-11.png"><br><figcaption>Set your API Key here</figcaption></figure>
    <br>
    
    <p>If we run now it should work.(it does not require locating activated at the moment)</p>    

    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-11-58-01.png"><br><figcaption></figcaption></figure>
    <br>
    
    <p><span class="negrita">NOTE</span> : When using location it is recommended to use real devices. 
        However, if simulation is required in Android Emulator, you must have a machine created with an image that has <span class="negrita">Google APIs.</span> </p>
    
    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-12-00-59.png"><br><figcaption></figcaption></figure>
    <br>
    
    <p>On the other hand, the locations are generated manually, in the extended controls</p>
    
    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-12-02-57.png"><br><figcaption></figcaption></figure>
    <br>
    
    <p>We are now going to review two aspects of the generated template, first the functionality, and secondly the initially generated code</p>
    
    <p>As for functionality, we immediately see the marker(permanently pointing to Sydney, southeast of Australia), and a Google icon in the lower left. 
        If we click on the marker, it will show us a title with the name of the place(in this case “Marker in Sydney”), 
        and two icons will appear at the bottom right, the first is for GO(navigate to the place), and the second to show location</p>

    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-12-04-59.png"><br><figcaption></figcaption></figure>
    <br>
    
    <p>If we double-click on any place on the map repeatedly it is enlarged, using the events of two fingers we can also enlarge, reduce or rotate, 
        in the latter case, an icon in the form of a compass appears on the upper left, which we allows to return the center to the north.</p>
    
    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-12-05-52.png"><br><figcaption></figcaption></figure>
    <br>
    

    <p>As for the code, we are going to review the important thing next</p>

    <p>Add dependency to the build gradle:app</p>
    
    <section class="marco-t file-">
        <span class="icono file"> </span> <span class="negrita">build-gradle(: app)</span>
        </section>
    <section class="marco-b">
            <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">implementation <span class="token string">'com.google.android.gms:play-services-maps:18.1.0'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
            </section>
    </section>
    
    <p>In <span class="inline-file">AndroidManifest.xml </span> file we've already set our <span class="d-word">API Key</span>  and also is set 
        <span class="negrita">location Permissions</span> </p>

    <section class="marco-t file-">
        <span class="icono file"> </span> <span class="negrita">AndroidManifest.xml </span>
        </section>
    <section class="marco-b">
            <section><div class="code-toolbar"><pre class="language-xml line-numbers" tabindex="0"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>android.permission.ACCESS_FINE_LOCATION<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
            </section>
    </section>
    <p>If we wanted to use the fuzzy location permission, which is the one obtained as a consequence of using the signal from the mobile phone or WiFi antennas, 
        we would use the <span class="negrita">ACCESS_COARSE_LOCATION</span>  permission, obviously this permission is essential for indoors. We also realize that 
        the activity that is initially launched thanks to the <span class="cursiva">intent-filter</span>  is <span class="negrita">MapsActivity</span> </p>
    
    <p>Regarding <span class="inline-file">activity_maps.xml</span>, just note that it is a <span class="negrita">fragment</span> , with id <span class="d-word">android:id="@+id/map</span> ".</p>

    <p>And to finish, in <span class="inline-file">MapsActivity.kt</span> we visualize the initial code.</p>
    
    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-class">class</span> MapsActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> OnMapReadyCallback <span class="token punctuation">{</span>

    <span class="token keyword keyword-private">private</span> <span class="token keyword keyword-lateinit">lateinit</span> <span class="token keyword keyword-var">var</span> mMap<span class="token operator">:</span> GoogleMap
    
    <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-super">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>

        binding <span class="token operator">=</span> ActivityMapsBinding<span class="token punctuation">.</span><span class="token function">inflate</span><span class="token punctuation">(</span>layoutInflater<span class="token punctuation">)</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>binding<span class="token punctuation">.</span>root<span class="token punctuation">)</span>

        <span class="token comment">// Obtain the SupportMapFragment and get notified when the map is ready to be used.</span>
        <span class="token keyword keyword-val">val</span> mapFragment <span class="token operator">=</span> supportFragmentManager
            <span class="token punctuation">.</span><span class="token function">findFragmentById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>map<span class="token punctuation">)</span> <span class="token keyword keyword-as">as</span> SupportMapFragment
        mapFragment<span class="token punctuation">.</span><span class="token function">getMapAsync</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Manipulates the map once available.
     * This callback is triggered when the map is ready to be used.
     * This is where we can add markers or lines, add listeners or move the camera. In this case,
     * we just add a marker near Sydney, Australia.
     * If Google Play services is not installed on the device, the user will be prompted to install
     * it inside the SupportMapFragment. This method will only be triggered once the user has
     * installed Google Play services and returned to the app.
     */</span>


    <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onMapReady</span><span class="token punctuation">(</span>googleMap<span class="token operator">:</span> GoogleMap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mMap <span class="token operator">=</span> googleMap

        <span class="token comment">// Add a marker in Sydney and move the camera</span>
        <span class="token keyword keyword-val">val</span> sydney <span class="token operator">=</span> <span class="token function">LatLng</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">34.0</span><span class="token punctuation">,</span> <span class="token number">151.0</span><span class="token punctuation">)</span>
        mMap<span class="token punctuation">.</span><span class="token function">addMarker</span><span class="token punctuation">(</span><span class="token function">MarkerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">position</span><span class="token punctuation">(</span>sydney<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"Marker in Sydney"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        mMap<span class="token punctuation">.</span><span class="token function">moveCamera</span><span class="token punctuation">(</span>CameraUpdateFactory<span class="token punctuation">.</span><span class="token function">newLatLng</span><span class="token punctuation">(</span>sydney<span class="token punctuation">)</span>   
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br><br>
    
    <p>Obviously a lot of code is missing here, due to the complexity of Maps everything works through libraries. It then extends the <span class="negrita">AppCompatActivity</span> 
         class, and implements the <span class="negrita">OnMapReadyCallback</span>  interface(since java does not support multiple inheritance). 
        Inside the class create the reference for the mMap object of the <span class="negrita">GoogleMap</span>  class, which will be our base object to work with. In the 
        <span class="cursiva">onCreate()</span>  use <span class="cursiva">setContentView()</span> to relate to the layout <span class="negrita">activity_maps</span>, 
        and then manage the fragment with id map, asynchronously loading the map into the fragment.</p>
    
    <p>By means of the <span class="d-word">onMapReady()</span> response function, when it is ready, it loads the data into mMap, and from here on, we can use it.
In line 32, we see how he creates an object with a fixed location using <span class="negrita">LatLng(,)</span> , using latitude -34 and longitude 151, in the following lines, 
add a marker in that place using <span class="d-word">addMarker()</span>  whose title is "Marker in Sydney ", and move the camera to that point using <span class="d-word">moveCamara()</span>.
<br>
Would it cost you a lot to modify it, so that the LatLng object is called torrent, and that the intersection of parallel 39.4295152 with the meridian -0.4660814 is shown on the map, also with the title "IES Serra Perenxisa"?</p>
    
<p>I don't think so, but, for now, surely you have had to expand the location manually. 
    The time has come to expand our knowledge of the options we have available to tune our project with Google Maps.</p>

<p>Before continuing, change the title that appears under the App icon, go to <span class="negrita">strings.xml</span>  and change the text of title_activity_maps to 
    &lt;string name="title_activity_maps"&gt; myMaps .</p>

<p class="sub-section">Map Options</p>

<p>We are going to see some of the most important options on the map</p>

<p><span class="d-word">LatLng()</span>  =&gt; </p><section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token punctuation">.</span><span class="token function">LatLng</span><span class="token punctuation">(</span>double latitude<span class="token punctuation">,</span> double longitude<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Create a locate point</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br> <br>
    <ul>
        <li>Example: 
            <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-val">val</span> torrent <span class="token operator">=</span> <span class="token function">LatLng</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
            </section><br><br>
        </li>
    </ul>
    <br>

<span class="d-word">AddMarker()</span>  =&gt; <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token punctuation">.</span><span class="token function">addMarker</span><span class="token punctuation">(</span><span class="token function">MarkerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">position</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Add bookmark with title</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>

<ul>
    <li>Example: <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"> mMap<span class="token punctuation">.</span><span class="token function">addMarker</span><span class="token punctuation">(</span><span class="token function">MarkerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">position</span><span class="token punctuation">(</span>torrent<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"Meridian Park"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br><br></li>
    <li>Other options: <span class="negrita">.snippet</span>("Inhabitants: 180000") // Add extra information below the title</li>
</ul>
<p></p>
<figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-12-50-25.png"><br><figcaption></figcaption></figure>
<br>

<p>It is possible to show or hide the title / snippet by code(without pressing the Marker), it would be like this.</p>
<p>To show it would be <span class="negrita">marker.showInfoWindow()</span> <br> To hide it would be <span class="negrita">marker.hideInfoWindow()</span> </p>

<p>It is also possible to assign an event to the title/snippet, so that when we click on them we do some action. 
    To achieve this effect, first we must also implement the <span class="negrita">GoogleMap.OnInfoWindowClickListener</span>  in our class, therefore, 
    now the double implementation will be like this(separated by commas):<span class="negrita"> OnMapReadyCallback, GoogleMap.OnInfoWindowClickListener</span> 
Next we add in <span class="negrita">onMapReady()</span>  the line <span class="negrita">mMap.setOnInfoWindowClickListener(this)</span>, 
and outside of onMapReady() we insert a response function <span class="negrita">onInfoWindowClickListener()</span> :</p>


<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onInfoWindowClick</span><span class="token punctuation">(</span>marker<span class="token operator">:</span> Marker<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> <span class="token string">"Marker pressed on: \n <span class="token interpolation"><span class="token delimiter variable">${</span>marker<span class="token punctuation">.</span>tag<span class="token delimiter variable">}</span></span>(<span class="token interpolation"><span class="token delimiter variable">${</span>marker<span class="token punctuation">.</span>position<span class="token punctuation">.</span>latitude<span class="token delimiter variable">}</span></span>"</span> <span class="token operator">+</span>
            <span class="token string">"<span class="token interpolation"><span class="token delimiter variable">${</span>marker<span class="token punctuation">.</span>position<span class="token punctuation">.</span>longitude<span class="token delimiter variable">}</span></span>)"</span><span class="token punctuation">,</span> Toast<span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>

<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onMapReady</span><span class="token punctuation">(</span>googleMap<span class="token operator">:</span> GoogleMap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    mMap <span class="token operator">=</span> googleMap

    <span class="token operator">..</span><span class="token operator">..</span><span class="token operator">..</span><span class="token operator">..</span><span class="token operator">..</span>

    mMap<span class="token punctuation">.</span><span class="token function">setOnInfoWindowClickListener</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>

<p>Notice how it reads the fixed position with <span class="negrita">marker.getPosition()</span> . Latitude and <span class="negrita">marker.getPosition()</span>. 
    Longitude, it also supports other interesting information like title with <span class="negrita">marker.title</span> .</p>

<p>Instead of reading the location or the title as in the previous photo, it could be interesting, 
    to have previously saved some information or <span class="negrita">Tag</span>(not visible) in the Marker and read it now by pressing. 
    To save a non-visible label in the marker we must obtain a reference to it when creating it, and then use it to add the label through <span class="negrita">.setTag("mytag")</span> , 
    then it would be read through <span class="negrita">.getTag()</span> or just the property <span class="negrita">.tag</span> , let's see an example:</p>


    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">marker<span class="token punctuation">.</span>tag <span class="token operator">=</span><span class="token string">"city"</span>
<span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token operator">..</span><span class="token punctuation">.</span>
marker<span class="token punctuation">.</span>tag <span class="token comment">// I could read it later in onInfoWindowClick()</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br><br>

    <p>Notice how a click counter could easily be made, since after reading it we could save it again with +1, <span class="negrita">marker.tag += 1</span> 
        , it would also be valid to act in one way or another depending on the type of Marker, that is, it would be worth to be able to identify it.</p>

    <p><span class="d-word">.icon()</span>  //Allows you to tune the Marker icon, for example change the color, or make it an image </p>
<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token punctuation">.</span><span class="token function">icon</span><span class="token punctuation">(</span>BitmapDescriptorFactory<span class="token punctuation">.</span><span class="token function">defaultMarker</span><span class="token punctuation">(</span>BitmapDescriptorFactory<span class="token punctuation">.</span>HUE_AZURE<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Blue color</span>
<span class="token punctuation">.</span><span class="token function">icon</span><span class="token punctuation">(</span>BitmapDescriptorFactory<span class="token punctuation">.</span><span class="token function">fromResource</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>mipmap<span class="token punctuation">.</span>busmarker<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Image from resource</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>
    
<figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-13-01-08.png"><br><figcaption></figcaption></figure>
<br>

<p>Example with everything so far:</p>

<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-val">val</span> marker <span class="token operator">=</span> mMap<span class="token punctuation">.</span><span class="token function">addMarker</span><span class="token punctuation">(</span><span class="token function">MarkerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">position</span><span class="token punctuation">(</span><span class="token function">LatLng</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"Park"</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">snippet</span><span class="token punctuation">(</span><span class="token string">"from the meridian"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">icon</span><span class="token punctuation">(</span>BitmapDescriptorFactory<span class="token punctuation">.</span><span class="token function">fromResource</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>mipmap<span class="token punctuation">.</span>park<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
marker<span class="token punctuation">.</span><span class="token function">setTag</span><span class="token punctuation">(</span><span class="token string">"parks"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>

<p>We can also add an event listener to the Marker itself, for example.</p>
<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">mMap<span class="token punctuation">.</span><span class="token function">setOnMarkerClickListener</span> <span class="token punctuation">{</span>
    marker <span class="token operator">-&gt;</span>
    Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> <span class="token string">"Click on Marker"</span><span class="token punctuation">,</span> Toast<span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword keyword-return">return</span><span class="token label symbol">@setOnMarkerClickListener</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>

    <p><span class="d-word">.clear()</span>  =&gt; Reset the map, removing all markers. Example: <span class="cursiva">mMap.clear()</span> </p>
    

    <p><span class="d-word">Marker.remove()</span> =&gt; Delete a specific marker. It is possible to get reference to a marker to remove it. <br>Example:</p>
    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-val">val</span> mMarker <span class="token operator">=</span> mMap<span class="token punctuation">.</span><span class="token function">addMarker</span><span class="token punctuation">(</span><span class="token function">MarkerOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">position</span><span class="token punctuation">(</span><span class="token function">LatLng</span><span class="token punctuation">(</span>mLatitude<span class="token punctuation">,</span> mLongitude<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"My position"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mMarker<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br><br>

<p><span class="d-word">.moveCamera()</span>  =&gt; .moveCamara(location | zoom) // Coordinates where the center of the screen will be located
Example:</p>
<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">mMap<span class="token punctuation">.</span><span class="token function">moveCamera</span><span class="token punctuation">(</span>CameraUpdateFactory<span class="token punctuation">.</span><span class="token function">newLatLng</span><span class="token punctuation">(</span>castellon<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>
    <p><span class="negrita">Other options</span>: mMap.moveCamera(CameraUpdateFactory.zoomTo(15)); // Change the zoom(0 by default, range 0-21, floats are described by an f, 
        example 6.5f.). Relationship between the zoom and what is expected to be displayed: 1-World 5- Continent 10-City 15-Streets 20-Buildings.</p>
    
    <p>We can generate a coordinate grid, that is, an area, and automatically calculate the center, to place the camera there, with a specific zoom. <br>Example:</p>
    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-val">val</span> MyAREA <span class="token operator">=</span> <span class="token function">LatLngBounds</span><span class="token punctuation">(</span><span class="token function">LatLng</span><span class="token punctuation">(</span><span class="token number">37.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">LatLng</span><span class="token punctuation">(</span><span class="token number">41.5</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
mMap<span class="token punctuation">.</span><span class="token function">moveCamera</span><span class="token punctuation">(</span>CameraUpdateFactory<span class="token punctuation">.</span><span class="token function">newLatLngZoom</span><span class="token punctuation">(</span>MyAREA<span class="token punctuation">.</span>center<span class="token punctuation">,</span> <span class="token number">7.5f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>

<p>It is possible to consult and set the minimum and maximum accepted zoom, as well as the current one.</p>

<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">mMap<span class="token punctuation">.</span><span class="token function">setMinZoomPreference</span><span class="token punctuation">(</span><span class="token number">8.0f</span><span class="token punctuation">)</span>
mMap<span class="token punctuation">.</span><span class="token function">setMaxZoomPreference</span><span class="token punctuation">(</span><span class="token number">16.0f</span><span class="token punctuation">)</span>
Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> <span class="token string">"Zoom min:"</span> <span class="token operator">+</span> mMap<span class="token punctuation">.</span><span class="token function">getMinZoomLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Toast<span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> <span class="token string">"Zoom max:"</span> <span class="token operator">+</span> mMap<span class="token punctuation">.</span><span class="token function">getMaxZoomLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Toast<span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> <span class="token string">"Current Zoom:"</span> <span class="token operator">+</span> mMap<span class="token punctuation">.</span><span class="token function">getCameraPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Zoom<span class="token punctuation">,</span> Toast<span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>


<p><span class="d-word">.SetOnCameraIdleListener ()</span> =&gt; Assign a listener to the camera movement, ideal for saving the zoom.</p>

<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">mMap<span class="token punctuation">.</span><span class="token function">setOnCameraIdleListener</span> <span class="token punctuation">{</span>
    Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span>
        <span class="token string">"Zoom changed to: "</span> <span class="token operator">+</span> mMap<span class="token punctuation">.</span>cameraPosition<span class="token punctuation">.</span>zoom<span class="token punctuation">,</span>
        Toast<span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>
<figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-13-13-38.png"><br><figcaption></figcaption></figure>
<br>

<p><span class="negrita">.setMapType()</span>  =&gt; </p><section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token punctuation">.</span><span class="token function">setMapType</span><span class="token punctuation">(</span>TypeMapConstant<span class="token punctuation">)</span> <span class="token comment">//Configures map type. Use better property</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br> <br>
Example:<p></p>
<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">mMap<span class="token punctuation">.</span>mapType <span class="token operator">=</span> GoogleMap<span class="token punctuation">.</span>MAP_TYPE_HYBRID<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>
<p>MapType can be:</p>

<figure><img src="./UD9 Multimedia_files/UD9-2023-01-25-08-45-21.png"><br><figcaption>Google Map Types</figcaption></figure>
<br>


<p><span class="d-word">.uiSettings () </span> =&gt; Allows you to configure various graphic aspects.
    </p><ul><li>Example 1: <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">mMap<span class="token punctuation">.</span>uiSettings<span class="token punctuation">.</span>isZoomControlsEnabled <span class="token operator">=</span> <span class="token boolean">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>
        Activates +/- controls at the bottom right that allow you to zoom in or out. Having touch gestures seems trivial, but it could be ideal for people with reduced mobility. <p></p>
        <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-13-18-17.png"><br><figcaption></figcaption></figure>
        <br>
        
    </li>
    <li>Example 2: <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">mMap<span class="token punctuation">.</span>uiSettings<span class="token punctuation">.</span>isCompassEnabled <span class="token operator">=</span> <span class="token boolean">false</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>
        Uninhibit the compass icon that appeared when rotating the map.
    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-13-18-35.png"><br><figcaption></figcaption></figure>
    <br>
    </li>
    <li>Example 3: <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">mMap<span class="token punctuation">.</span>uiSettings<span class="token punctuation">.</span>isRotateGesturesEnabled <span class="token operator">=</span> <span class="token boolean">false</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br>
        Prohibits the ability to rotate the map with touch gestures.</li>
    
    
    <li>
        Example 4: <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">mMap<span class="token punctuation">.</span>uiSettings<span class="token punctuation">.</span>isMapToolbarEnabled <span class="token operator">=</span> <span class="token boolean">false</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section><br>
Uninhibit the icons on the bottom right that appeared when pressing a marker.
        <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-13-18-59.png"><br><figcaption></figcaption></figure>
        <br>
        
    </li>
    
    </ul>


    <br>
    <p><span class="d-word">.setOnMapClickListener ()</span>  =&gt; Assign an onClick listener to the map itself. <br> Example.</p>
    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">mMap<span class="token punctuation">.</span><span class="token function">setOnMapClickListener</span> <span class="token punctuation">{</span>latlng <span class="token operator">-&gt;</span>
    Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span>
        <span class="token string">"Map clicked on lat: <span class="token interpolation"><span class="token delimiter variable">${</span>latlng<span class="token punctuation">.</span>latitude<span class="token delimiter variable">}</span></span>, long: <span class="token interpolation"><span class="token delimiter variable">${</span>latlng<span class="token punctuation">.</span>longitude<span class="token delimiter variable">}</span></span>"</span><span class="token punctuation">,</span>
        Toast<span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br><br>

<p><span class="d-word">.animateCamera()</span>  =&gt; Allows you to create animations while positioning the camera.
Example: Simulates “flying” between one point and another (-_-)</p>

<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-val">val</span> SYDNEY <span class="token operator">=</span> <span class="token function">LatLng</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">33.88</span><span class="token punctuation">,</span><span class="token number">151.21</span><span class="token punctuation">)</span>
<span class="token keyword keyword-val">val</span> MOUNTAIN_VIEW <span class="token operator">=</span> <span class="token function">LatLng</span><span class="token punctuation">(</span><span class="token number">37.4</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">122.1</span><span class="token punctuation">)</span>
mMap<span class="token punctuation">.</span><span class="token function">moveCamera</span><span class="token punctuation">(</span>CameraUpdateFactory<span class="token punctuation">.</span><span class="token function">newLatLngZoom</span><span class="token punctuation">(</span>SYDNEY<span class="token punctuation">,</span> <span class="token number">15f</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//Starts with zoom of 15 zoom</span>
mMap<span class="token punctuation">.</span><span class="token function">animateCamera</span><span class="token punctuation">(</span>CameraUpdateFactory<span class="token punctuation">.</span><span class="token function">zoomIn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
mMap<span class="token punctuation">.</span><span class="token function">animateCamera</span><span class="token punctuation">(</span>CameraUpdateFactory<span class="token punctuation">.</span><span class="token function">zoomTo</span><span class="token punctuation">(</span><span class="token number">10f</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">,</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span> <span class="token comment">//5 seconds</span>
<span class="token keyword keyword-val">val</span> cameraPosition <span class="token operator">=</span> CameraPosition<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">target</span><span class="token punctuation">(</span>MOUNTAIN_VIEW<span class="token punctuation">)</span> <span class="token comment">//final destination</span>
        <span class="token punctuation">.</span><span class="token function">zoom</span><span class="token punctuation">(</span><span class="token number">17f</span><span class="token punctuation">)</span> <span class="token comment">//new final zoom</span>
        <span class="token punctuation">.</span><span class="token function">bearing</span><span class="token punctuation">(</span><span class="token number">90f</span><span class="token punctuation">)</span> <span class="token comment">//camera orientation to the east</span>
        <span class="token punctuation">.</span><span class="token function">tilt</span><span class="token punctuation">(</span><span class="token number">30f</span><span class="token punctuation">)</span> <span class="token comment">//camera to 30 degrees</span>
        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mMap<span class="token punctuation">.</span><span class="token function">animateCamera</span><span class="token punctuation">(</span>CameraUpdateFactory<span class="token punctuation">.</span><span class="token function">newCameraPosition</span><span class="token punctuation">(</span>cameraPosition<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>

<p><span class="d-word">.setMapStyle()</span>  =&gt; Allows importing custom map styles (Custom map) from <span class="negrita">JSON</span>  or <span class="negrita">XML</span>. 
    We need to create the raw folder, from <span class="negrita">App&gt; New&gt; Android resource directory</span> </p>

<p>We copy inside <span class="negrita">style_json.json</span> , it can be moved directly by dragging (then open the json with its own
Android Studio to study it). <a class="enlace" target="_blank" href="https://sdram58.github.io/apuntesPMDM/unidades2223/UD9/assets/style_json.json">style_json.json</a> </p>

<p>To use it. <br>
    </p><section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">mMap<span class="token punctuation">.</span><span class="token function">setMapStyle</span><span class="token punctuation">(</span>MapStyleOptions<span class="token punctuation">.</span><span class="token function">loadRawResourceStyle</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> R<span class="token punctuation">.</span>raw<span class="token punctuation">.</span>style_json<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
    </section><br><br>
<p></p>

<figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-13-26-37.png"><br><figcaption></figcaption></figure>
<br>
<p><span class="negrita">Url</span> : json styles reference <br> <a class="enlace" target="_blank" href="https://developers.google.com/maps/documentation/android-sdk/style-reference">https://developers.google.com/maps/documentation/android-sdk/style-reference</a> </p>

<p><span class="negrita">Url</span> : Easy to use online style editor (allows you to create a style and export it directly to JSON). Note that there is a new tool for editing styles <br>
<a class="enlace" target="_blank" href="https://mapstyle.withgoogle.com/">https://mapstyle.withgoogle.com/</a> </p>

<figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-13-27-08.png"><br><figcaption></figcaption></figure>
<br>

<figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-13-30-32.png"><br><figcaption></figcaption></figure>
<br>

<p><span class="d-word">.setMyLocationEnabled(true)</span> =&gt; Activates an icon in the upper right part, which when pressed allows the Google Maps API to find us, 
    and place the camera at that point (requires having the active location). 
    But it has a problem, this option requires making sure before its execution, and unequivocally, that our App has the location permission activated, 
    otherwise, the App will do what is known as a “crash”.</p>

<figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-13-31-33.png"><br><figcaption></figcaption></figure>
<br>

<p><span class="negrita">NOTE</span>: We are not referring to having the location active on the device, we are talking about express permission to the specific 
    App to access the location. </p>

    <p>Formerly these permissions were granted by the user when installing the App, but since Android 6.0 (API
23) is no longer like that. The philosophy since then is that the permissions considered high risk, such as location, the user has to allow them at runtime from 
the App itself, at least the first time that service is used. </p>


<p><span class="negrita">NOTE</span> : Once the App is installed, as you know, you can also go to <span class="negrita">Settings &gt; Applications &gt; our App</span>  and grant it the permission manually from there.</p>

    <!------------------------------------------Google Geolocation Services API------------------------------------------------->
    <h3>Google Geolocation Services API</h3>

    <p>It is time to activate real-time location with other means, which will require a greater effort on our part, but we will have greater control. To obtain it there are several ways, remember that instead
         of using android.location we are going to use the Google Location Services API.
          Therefore, we are no longer going to use the icon that we just activated using <span class="negrita">setMyLocationEnabled()</span> .</p>

        <p>We have already made sure before having the Google SDK tool installed in Android Studio Play Services. 
            Now we need to add it to our project. Do the following and sync the gradle. </p>
    
    <p></p>Now add these services in our project, in the <span class="inline-file">build.gradle (:app)</span> put: <p></p>

<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">implementation <span class="token string">'com.google.android.gms:play-services-location:21.0.1'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>

<p>We continue with the code on <span class="inline-file">MapsActivity.kt</span>. Add at the beginning of the class the references:</p>
<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-private">private</span> <span class="token keyword keyword-lateinit">lateinit</span> <span class="token keyword keyword-var">var</span> mMap<span class="token operator">:</span> GoogleMap
<span class="token keyword keyword-private">private</span> <span class="token keyword keyword-lateinit">lateinit</span> <span class="token keyword keyword-var">var</span> binding<span class="token operator">:</span> ActivityMapsBinding

<span class="token keyword keyword-private">private</span> <span class="token keyword keyword-lateinit">lateinit</span> <span class="token keyword keyword-var">var</span> mFusedLocationClient<span class="token operator">:</span> FusedLocationProviderClient
<span class="token keyword keyword-private">private</span> <span class="token keyword keyword-var">var</span> mLatitude <span class="token operator">=</span> <span class="token number">0.0</span>
<span class="token keyword keyword-private">private</span> <span class="token keyword keyword-var">var</span> mLongitude <span class="token operator">=</span> <span class="token number">0.0</span>
<span class="token keyword keyword-private">private</span> <span class="token keyword keyword-lateinit">lateinit</span> <span class="token keyword keyword-var">var</span> locationRequest<span class="token operator">:</span> LocationRequest
<span class="token keyword keyword-private">private</span> <span class="token keyword keyword-lateinit">lateinit</span> <span class="token keyword keyword-var">var</span> locationCallback<span class="token operator">:</span> LocationCallback<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>

<p>Then expand the <span class="r-word">onCreate()</span> :</p>
<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">mFusedLocationClient <span class="token operator">=</span> LocationServices<span class="token punctuation">.</span><span class="token function">getFusedLocationProviderClient</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>

<span class="token keyword keyword-val">val</span> locationRequestBuilder <span class="token operator">=</span> LocationRequest<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token number">16000</span><span class="token punctuation">)</span>
locationRequestBuilder<span class="token punctuation">.</span><span class="token function">setDurationMillis</span><span class="token punctuation">(</span>Long<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">)</span>
locationRequestBuilder<span class="token punctuation">.</span><span class="token function">setQuality</span><span class="token punctuation">(</span>LocationRequest<span class="token punctuation">.</span>QUALITY_BALANCED_POWER_ACCURACY<span class="token punctuation">)</span>
locationRequestBuilder<span class="token punctuation">.</span><span class="token function">setMinUpdateDistanceMeters</span><span class="token punctuation">(</span><span class="token number">0f</span><span class="token punctuation">)</span>
locationRequest <span class="token operator">=</span> locationRequestBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


locationCallback <span class="token operator">=</span> <span class="token keyword keyword-object">object</span><span class="token operator">:</span> <span class="token function">LocationCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onLocationResult</span><span class="token punctuation">(</span>locationResult<span class="token operator">:</span> LocationResult<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword keyword-super">super</span><span class="token punctuation">.</span><span class="token function">onLocationResult</span><span class="token punctuation">(</span>locationResult<span class="token punctuation">)</span>
        <span class="token keyword keyword-for">for</span><span class="token punctuation">(</span>location <span class="token keyword keyword-in">in</span> locationResult<span class="token punctuation">.</span>locations<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>location<span class="token operator">!</span> <span class="token operator">=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                mLatitude <span class="token operator">=</span> location<span class="token punctuation">.</span>latitude
                mLongitude <span class="token operator">=</span> location<span class="token punctuation">.</span>longitude
                Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token label symbol">@MapsActivity</span><span class="token punctuation">,</span> <span class="token string">"Lat:"</span> <span class="token operator">+</span> mLatitude <span class="token operator">+</span> <span class="token string">"Lon:"</span> <span class="token operator">+</span>
                        mLongitude<span class="token punctuation">,</span> Toast<span class="token punctuation">.</span>LENGTH_LONG<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>

<p>And create at the end, but inside the class the methods:</p>

<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-private">private</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">requestLocations</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>ActivityCompat<span class="token punctuation">.</span><span class="token function">checkSelfPermission</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token label symbol">@MapsActivity</span><span class="token punctuation">,</span>
            android<span class="token punctuation">.</span>Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>ACCESS_FINE_LOCATION<span class="token punctuation">)</span> <span class="token operator">!=</span> PackageManager<span class="token punctuation">.</span>PERMISSION_GRANTED <span class="token operator">&amp;&amp;</span> ActivityCompat<span class="token punctuation">.</span><span class="token function">checkSelfPermission</span><span class="token punctuation">(</span>
            <span class="token keyword keyword-this">this</span><span class="token label symbol">@MapsActivity</span><span class="token punctuation">,</span>
            android<span class="token punctuation">.</span>Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>ACCESS_COARSE_LOCATION<span class="token punctuation">)</span> <span class="token operator">!=</span> PackageManager<span class="token punctuation">.</span>PERMISSION_GRANTED
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ActivityCompat<span class="token punctuation">.</span><span class="token function">requestPermissions</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token label symbol">@MapsActivity</span><span class="token punctuation">,</span>
            <span class="token function">arrayOf</span><span class="token punctuation">(</span>android<span class="token punctuation">.</span>Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>ACCESS_FINE_LOCATION<span class="token punctuation">,</span>
                android<span class="token punctuation">.</span>Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>ACCESS_COARSE_LOCATION<span class="token punctuation">)</span><span class="token punctuation">,</span>
            REQUEST_PERSMISSION_CODE<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword keyword-else">else</span> <span class="token punctuation">{</span>
        mFusedLocationClient<span class="token operator">!!</span><span class="token punctuation">.</span><span class="token function">requestLocationUpdates</span><span class="token punctuation">(</span>locationRequest<span class="token operator">!!</span><span class="token punctuation">,</span>
            locationCallback<span class="token operator">!!</span><span class="token punctuation">,</span> Looper<span class="token punctuation">.</span><span class="token function">getMainLooper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-private">private</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">removeLocations</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    mFusedLocationClient<span class="token operator">!!</span><span class="token punctuation">.</span><span class="token function">removeLocationUpdates</span><span class="token punctuation">(</span>locationCallback<span class="token operator">!!</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>

<p>Notice that a location update interval has been set. From now on, when you want to activate the location, call:
<br>
    <span class="negrita">requestLocations()</span>  <br> <br>
And to stop the location updates: <br>
<span class="negrita">removeLocations()</span> </p>

<p>The result is (note that at the moment we only show the coordinates through a <span class="negrita">Toast</span>,once we have them, we can place a marker with our photo in it, place the camera there, send them to another App through an Intent, save them, etc. ):</p>

<figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-14-54-21.png"><br><figcaption></figcaption></figure>
<br>

<p><span class="negrita">NOTE</span> : Because the precise location consumes a lot, a balanced consumption has been chosen, 
    this is configurable through <span class="negrita">LocationRequest.PRIORITY_BALANCED_POWER_ACCURACY</span> , the available ones are:</p>
<figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-14-57-01.png"><br><figcaption></figcaption></figure>
<br>
<figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-14-57-12.png"><br><figcaption></figcaption></figure>
<br>

<p><span class="negrita">NOTE</span> : In addition to latitude and longitude, through location we can also obtain other data, such as altitude, speed and precision.</p>

<p>Another interesting option for location is to be able to calculate the distance between the current location, and another that we send as 
    a parameter, <span class="negrita">location.distanteTo(Location des)</span>. Example:</p>
<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-val">val</span> destinationLocation<span class="token operator">:</span> Location <span class="token operator">=</span> <span class="token function">Location</span><span class="token punctuation">(</span><span class="token string">"destinationLocation"</span><span class="token punctuation">)</span> 
destinationLocation<span class="token punctuation">.</span>latitude <span class="token operator">=</span> <span class="token number">40.0</span> 
destinationLocation<span class="token punctuation">.</span>longitude <span class="token operator">=</span> <span class="token number">0.0</span>
Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token label symbol">@MapsActivity</span><span class="token punctuation">,</span>
    <span class="token string">"Distancia: "</span> <span class="token operator">+</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>String<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%.2f"</span><span class="token punctuation">,</span>
        location<span class="token punctuation">.</span><span class="token function">distanceTo</span><span class="token punctuation">(</span>destinationLocation<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" Km"</span><span class="token punctuation">,</span>
    Toast<span class="token punctuation">.</span>LENGTH_LONG<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>

<p>The above code provides us with the distance between our current location and other location.</p>

<figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-15-02-42.png"><br><figcaption></figcaption></figure>
<br>

<p><span class="negrita">Url</span> : Location and context overview <br>
<a class="enlace" target="_blank" href="https://developer.android.com/training/location?hl=es-419">https://developer.android.com/training/location?hl=es-419</a> </p>

    
    <!------------------------------------------XML data reading------------------------------------------------->
    <h3>XML data reading</h3>
    <p>In practice, we are going to import location data from an XML file that we will put as a resource in the project itself, 
        so that by selecting an option from the side menu we fill the map with markers, which will indicate the locations stored in the file. 
        This document will be called locations.xml, and we will place it inside the raw folder, along with the map style json previously seen in this topic. 
        The XML format will be as in the following example:</p>

        <section class="marco-t file-">
            <span class="icono file"> </span> <span class="negrita">locations.xml</span>
            </section>
        <section class="marco-b">
            <section><div class="code-toolbar"><pre class="language-xml line-numbers" tabindex="0"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>locations</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>location</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Cardenal RAM<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fragment</span><span class="token punctuation">&gt;</span></span>https://hotelcardenalram.com/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fragment</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tag</span><span class="token punctuation">&gt;</span></span>hotel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tag</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>latitude</span><span class="token punctuation">&gt;</span></span>40.6181083<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>latitude</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>longitude</span><span class="token punctuation">&gt;</span></span>-0.1036815<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>longitude</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>location</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>location</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Palau dels Osset<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fragment</span><span class="token punctuation">&gt;</span></span>https://palaudelsosset.com/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fragment</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tag</span><span class="token punctuation">&gt;</span></span>hotel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tag</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>latitude</span><span class="token punctuation">&gt;</span></span>40.6453629<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>latitude</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>longitude</span><span class="token punctuation">&gt;</span></span>-0.1992183<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>longitude</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>location</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>location</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Turismo Morella<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fragment</span><span class="token punctuation">&gt;</span></span>964173032<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fragment</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tag</span><span class="token punctuation">&gt;</span></span>ciudad<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tag</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>latitude</span><span class="token punctuation">&gt;</span></span>40.6214498<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>latitude</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>longitude</span><span class="token punctuation">&gt;</span></span>-0.1012665<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>longitude</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>location</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>location</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>El Forcall<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fragment</span><span class="token punctuation">&gt;</span></span>964171290<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fragment</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tag</span><span class="token punctuation">&gt;</span></span>ciudad<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tag</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>latitude</span><span class="token punctuation">&gt;</span></span>40.6460531<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>latitude</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>longitude</span><span class="token punctuation">&gt;</span></span>-0.2002412<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>longitude</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>location</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>locations</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
                 </section>
        </section>
        
    <br><br>
    
    <p>As can be seen, there are two types of locations, hotel and city, the first have the URL of their website as a fragment, 
        and the second the local tourist telephone number, this will be used later in practice to give it some functionality. 
        To read the XML we are going to use the W3C DOM methods. </p>

    <p>We will need to create the data model, for which we will create a new class, inside the java folder, we go to our package, and we right <span class="negrita">click &gt; New &gt; kotlin Class </span> </p>
    
<section class="marco-t file-">
    <span class="icono file"> </span> <span class="negrita">Location.kt</span>
    </section>
<section class="marco-b">
    <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-package">package</span> com<span class="token punctuation">.</span>catata<span class="token punctuation">.</span>googlemapsexample

<span class="token keyword keyword-import">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>Context

<span class="token keyword keyword-import">import</span> org<span class="token punctuation">.</span>w3c<span class="token punctuation">.</span>dom<span class="token punctuation">.</span>Document
<span class="token keyword keyword-import">import</span> org<span class="token punctuation">.</span>w3c<span class="token punctuation">.</span>dom<span class="token punctuation">.</span>Element
<span class="token keyword keyword-import">import</span> org<span class="token punctuation">.</span>w3c<span class="token punctuation">.</span>dom<span class="token punctuation">.</span>Node
<span class="token keyword keyword-import">import</span> org<span class="token punctuation">.</span>w3c<span class="token punctuation">.</span>dom<span class="token punctuation">.</span>NodeList
<span class="token keyword keyword-import">import</span> org<span class="token punctuation">.</span>xml<span class="token punctuation">.</span>sax<span class="token punctuation">.</span>SAXException
<span class="token keyword keyword-import">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException
<span class="token keyword keyword-import">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>Constructor
<span class="token keyword keyword-import">import</span> javax<span class="token punctuation">.</span>xml<span class="token punctuation">.</span>parsers<span class="token punctuation">.</span>DocumentBuilder
<span class="token keyword keyword-import">import</span> javax<span class="token punctuation">.</span>xml<span class="token punctuation">.</span>parsers<span class="token punctuation">.</span>DocumentBuilderFactory
<span class="token keyword keyword-import">import</span> javax<span class="token punctuation">.</span>xml<span class="token punctuation">.</span>parsers<span class="token punctuation">.</span>ParserConfigurationException


<span class="token keyword keyword-data">data</span> <span class="token keyword keyword-class">class</span> <span class="token function">Location</span><span class="token punctuation">(</span>
    <span class="token keyword keyword-var">var</span> title<span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword keyword-var">var</span> fragment<span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword keyword-var">var</span> tag<span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword keyword-var">var</span> latitude<span class="token operator">:</span> Double<span class="token punctuation">,</span>
    <span class="token keyword keyword-var">var</span> longitude<span class="token operator">:</span> Double<span class="token punctuation">,</span>

<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-constructor">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token keyword keyword-this">this</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token number">0.0</span><span class="token punctuation">,</span><span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token punctuation">}</span>


    <span class="token keyword keyword-companion">companion</span> <span class="token keyword keyword-object">object</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-fun">fun</span> <span class="token function">readLocations</span><span class="token punctuation">(</span>context<span class="token operator">:</span> Context<span class="token punctuation">)</span><span class="token operator">:</span> List<span class="token operator">&lt;</span>Location<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword keyword-val">val</span> locations <span class="token operator">=</span> mutableListOf<span class="token operator">&lt;</span>Location<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token keyword keyword-try">try</span> <span class="token punctuation">{</span>
                <span class="token keyword keyword-val">val</span> factory<span class="token operator">:</span> DocumentBuilderFactory <span class="token operator">=</span> DocumentBuilderFactory<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword keyword-val">val</span> builder<span class="token operator">:</span> DocumentBuilder <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">newDocumentBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword keyword-val">val</span> doc<span class="token operator">:</span> Document <span class="token operator">=</span>
                    builder<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>resources<span class="token punctuation">.</span><span class="token function">openRawResource</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>raw<span class="token punctuation">.</span>locations<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword keyword-val">val</span> root<span class="token operator">:</span> Element <span class="token operator">=</span> doc<span class="token punctuation">.</span>documentElement
                <span class="token keyword keyword-val">val</span> items<span class="token operator">:</span> NodeList <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"location"</span><span class="token punctuation">)</span>
                <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>i <span class="token keyword keyword-in">in</span> <span class="token number">0</span> until items<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//go through all elements</span>
                    <span class="token keyword keyword-val">val</span> locationNode<span class="token operator">:</span> Node <span class="token operator">=</span> items<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
                    <span class="token keyword keyword-val">val</span> location <span class="token operator">=</span> <span class="token function">Location</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>j <span class="token keyword keyword-in">in</span> <span class="token number">0</span> until locationNode<span class="token punctuation">.</span>childNodes<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//go through children</span>
                        <span class="token keyword keyword-val">val</span> currentNode<span class="token operator">:</span> Node <span class="token operator">=</span> locationNode<span class="token punctuation">.</span>childNodes<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>
                        <span class="token comment">//check if is an element</span>
                        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>currentNode<span class="token punctuation">.</span>nodeType <span class="token operator">===</span> Node<span class="token punctuation">.</span>ELEMENT_NODE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword keyword-when">when</span> <span class="token punctuation">(</span>currentNode<span class="token punctuation">.</span>nodeName<span class="token punctuation">.</span><span class="token function">uppercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                <span class="token string">"TITLE"</span> <span class="token operator">-&gt;</span> location<span class="token punctuation">.</span>title <span class="token operator">=</span> currentNode<span class="token punctuation">.</span>childNodes<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>nodeValue
                                <span class="token string">"FRAGMENT"</span> <span class="token operator">-&gt;</span> location<span class="token punctuation">.</span>fragment <span class="token operator">=</span>
                                    currentNode<span class="token punctuation">.</span>childNodes<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>nodeValue
                                <span class="token string">"TAG"</span> <span class="token operator">-&gt;</span> location<span class="token punctuation">.</span>tag <span class="token operator">=</span> currentNode<span class="token punctuation">.</span>childNodes<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>nodeValue
                                <span class="token string">"LATITUDE"</span> <span class="token operator">-&gt;</span> location<span class="token punctuation">.</span>latitude <span class="token operator">=</span>
                                    currentNode<span class="token punctuation">.</span>childNodes<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>nodeValue<span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                <span class="token string">"LONGITUDE"</span> <span class="token operator">-&gt;</span> location<span class="token punctuation">.</span>longitude <span class="token operator">=</span>
                                    currentNode<span class="token punctuation">.</span>childNodes<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>nodeValue<span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span>

                    <span class="token punctuation">}</span> <span class="token comment">//end for 2 (children)</span>
                    locations<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span>
                <span class="token punctuation">}</span> <span class="token comment">//end for 1 (elementos)</span>
            <span class="token punctuation">}</span> <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> ParserConfigurationException<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span> <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> IOException<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span> <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> SAXException<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>


            <span class="token keyword keyword-return">return</span> locations
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
            </section> 
</section>

    <br><br>

    <p>To test it now, we can put the following Toast in the first option of the side menu. </p>

<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin">Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>MapsActivity<span class="token punctuation">.</span>this<span class="token punctuation">,</span> <span class="token string">"Tit(1):"</span> <span class="token operator">+</span> <span class="token function">readLocations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Toast<span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>

<p>When testing we see how the title of the second item is displayed:</p>

<figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-15-11-00.png"><br><figcaption></figcaption></figure>
<br>
<p>Normally we will need to receive the entire List&lt;&gt; first, and then go through it, it could be like this:</p>
<section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-var">var</span> titles<span class="token operator">:</span>String <span class="token operator">=</span> <span class="token string">""</span>
        <span class="token keyword keyword-val">val</span> locations <span class="token operator">=</span> Location<span class="token punctuation">.</span><span class="token function">readLocations</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>location<span class="token operator">:</span>Location <span class="token keyword keyword-in">in</span> locations<span class="token punctuation">)</span><span class="token punctuation">{</span>
            titles <span class="token operator">+=</span> <span class="token string">"- "</span> <span class="token operator">+</span> location<span class="token punctuation">.</span>title <span class="token operator">+</span> <span class="token string">" "</span>
        <span class="token punctuation">}</span>
        Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">,</span> <span class="token string">"Titles: <span class="token interpolation variable">$titles</span>"</span><span class="token punctuation">,</span> Toast<span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
</section><br><br>
<p>
    <a class="enlace" target="_blank" href="https://github.com/sdram58/PMDM2021/tree/master/GoogleMapsExample">Here </a> you have GoogleMaps app with some snippets of code. 
</p>

    </section> <!-- End Section-->
    
    <!------------------------------------------Practice------------------------------------------------->
    <section class="apartado">
        <a name="sPractice"> </a>
        <h2> Practice </h2>
        <div class="tarea">

    <p>Let's start from the base already created after following the previous point, <span class="negrita">DO NOT CHANGE</span>  the package name
Neither of the App, you would have problems with the KEY, or just create a new API Key, simply, for safety, save a copy of the folder before starting. 
Therefore, we should already have the myMaps project created, when opening it you should see the map perfectly.</p>
    

<p>For this example, I have used the hotel and city location types, which are placed in the XML tag called precisely "tag", the values ​​of said tag after 
    reading them from the file we will put them later in the Tag of each marker (which will be invisible). 
    Now you have to devise two different types of locations, that are to your liking but different from these, you have to get <span class="negrita">at least five 
    locations</span>  of each, and modify <span class="inline-file">locations.xml</span> so that those ten locations appear at least, the order does
     not matter but put them interspersed better. Just like in my example, in the <span class="negrita">fragment</span> tag, 
     those of a type they will have the <span class="negrita">URL of its website</span> ,      and those of another will have <span class="negrita">its phone</span>. 
     To get its exact latitudes/longitudes you can use the google Maps URL as shown below, it appears when you click on its marker. Look for places not too far away 
     so they look good on the map.</p>

    <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-15-17-31.png"><br><figcaption></figcaption></figure>
    <br>
    
    <p>The intended functionality will be the following:</p>
    <p>
        </p><ol>
            <li>
                As soon as you enter myMaps, the camera should be focused on the town hall of your town, with a zoom between 5.0f and 12.0f as you see that it is better. 
                You don't have to see any marker. You also don't have to see the top right icon of my location. It would be ideal that the locations you choose are all 
                within that visible area, although it is not mandatory. Rotation with two fingers <span class="subrayado">must be prohibited</span>. Zoom icons +/- must be hidden.
            </li> <br>
            <li>
                Regarding the style of the map, you have to edit one through the online style editor website
                 <a class="enlace" target="_blank" href="https://mapstyle.withgoogle.com/">https://mapstyle.withgoogle.com/</a> ,
                  do it to your liking, import it into the project in JSON and make that style be displayed, mine has stayed like this (focused on the city of Valencia):
                  <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-15-20-25.png"><br><figcaption></figcaption></figure>
                  <br>
                  
            </li>
            <li>
                Put an icon consistent with the functionality of the App, and different from mine. 
                Overwrite the ic_launcher with the Image Asset, but don't delete the ic_launcher_round. Create it in legacy only and landscape mode. Mine is the following:
                <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-15-24-41.png"><br><figcaption></figcaption></figure>
                <br>
                
            </li>

            <li>
                Configure the side menu as in the following image, it will have the same icon as the background photo. 
                But beware, in the icon leave the ic_launcher_round with the image of the Android robot's face
                <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-15-24-59.png"><br><figcaption></figcaption></figure>
                <br>
                Notice that there are two separators, the three main options (see) are primary, that's why they look darker, 
                and the rest are secondary. Remember that in your practice it will not be hotels and cities
            </li> <br>
            <li>
                Give functionality to the last two options, Close menu and Exit App, since they are the simplest
            </li> <br>
            <li>
                Now we will make the code for the first option <span class="negrita">See my location</span>. 
                To achieve it use the <span class="negrita">Google Location Services API</span>  as it is in the notes, therefore to activate the location is as 
                simple as calling <span class="negrita">requestLocations()</span>. Once the coordinates have been calculated, you have to show a marker in that position,
                 <span class="negrita">requestLocations ()</span>  then place the camera there, <span class="subrayado">the marker will be a passport-size photo of us</span>. 
                 When you press the marker, you must see the title "My location", it also adds the label myposition to the marker using <span class="negrita"><span class="cursiva">marker.tag = "myposition"</span></span>.
                  In addition, the marker and the camera have to move periodically if we move, this really only comes out since in the example of the notes the location was already
                  updated due to using a setInterval, so every time the location is updated we should will create a new marker. 
                  To do this, you could create in the class a new attribute private <span class="cursiva negrita">List&lt;Marker&gt; mPosiciones = List&lt;&gt;()</span> ,
                   and then in <span class="cursiva negrita">onLocationResult</span>, go putting in that vector the markers, 
                   <span class="cursiva negrita">mPosiciones.add(mMap.addMarker(xxx)</span> , and then move the camera.

                <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-15-34-12.png"><br><figcaption></figcaption></figure> <br>              
                Expand the code so that, if we click on the title of our marker, our current coordinates appear in an AlertDialog, 
                configured as in the following image. Note that for this, you have to first use <span class="negrita">setOnInfoWindowClickListener</span>  to activate the event, 
                and then <span class="negrita">onInfoWindowClick</span>  to manage it, the coordinates are obtained from the reference to the marker object itself, 
                which is created and automatically sent to <span class="negrita">onInfoWindowClick(marker:Marker)</span>  when clicking on the title, 
                so you should use <span class="negrita">getPosition</span>  in the marker. You must send the information in the form of String to
                 the <span class="negrita">AlertDialog</span> . The <span class="negrita">CANCEL</span>  button does not have to appear

                 <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-15-36-22.png"><br><figcaption></figcaption></figure>
                 
                 
            </li> <br>

            <li>
                Now program the second option "Hide my location", which has to stop updating the location and delete all the markers. 
                To stop the location is as simple as calling removeLocations (). However, to delete the markers, keep in mind that they have been added to a vector, 
                therefore, we must go through it and delete the markers one by one. It would be something like this:
                <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-for">for</span><span class="token punctuation">(</span>marker <span class="token keyword keyword-in">in</span> mPositions<span class="token punctuation">)</span><span class="token punctuation">{</span>
    marker<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
                </section>
            </li> <br>
            <li>
                The <span class="d-word">See hotels</span>  option has some things (remember that in your practice they will not be hotels). 
                We must read through <span class="cursiva negrita">readLocations()</span>  all the XML, then we go through the List&lt;&gt; vector, and for 
                all the elements that have the label set to hotel (in your case the label will be another), 
                we will have to place them on the map by means of a marker with their corresponding coordinates. In addition, in each marker we will 
                add the title, the snippet, and the Tag that come in the same XML as title, fragment and tag respectively. On the other hand, you have to put 
                an icon consistent with the type of place to be pointed out, in my case a hotel, I call the resource a hotel. It is recommended to create a method 
                for this section, for example <span class="negrita">seeHotels()</span>
            </li>
            <br>

            <li>
                With the option <span class="d-word">See cities</span>  (remember that yours will not be cities), obviously we intend the same as in the previous point, 
                but with the locations that have the label city. To differentiate the icon it will be different, in my case I call the icon resource city. 
                For this purpose, you can do another method <span class="cursiva negrita">seeCities()</span> .
                 I propose better to modify the previous method so that it accepts a String, and call it <span class="cursiva negrita">seeMarkers(tag:String)</span> , 
                 in this way the same method can be used for both types, that is, the call would be <span class="cursiva negrita">seeMarkers("hotel")</span>
                  or <span class="cursiva negrita">seeMarkers("city")</span>, 
                 precisely when the hotel or city icons are called, which is precisely the label, the method is easy, even so we could require an if 
                 to add one icon or another, depending on the label. 
                  <br> <br>
                  We see the result (we can see the title and the snippet added to the markers)
                  <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-15-47-02.png"><br><figcaption></figcaption></figure>
                  <br>
                  
            </li>
            <br>

            <li>
                Make clicking on <span class="negrita">Hide all</span>  delete all the markers, including those of our location if it is active. 
                Just in case location is on, turn it off too. Look at the notes, the map has a method to clean it completely.
            </li><br>

            <li>
                To finish, click on the title of the bookmark to open the corresponding activity, if it is a url it will show us the web page and if it is a phone it will open the call application.
                For this you must read the marker label and depending on this do one thing or another.

                <section><div class="code-toolbar"><pre class="language-kotlin line-numbers" tabindex="0"><code class="language-kotlin"><span class="token keyword keyword-override">override</span> <span class="token keyword keyword-fun">fun</span> <span class="token function">onInfoWindowClick</span><span class="token punctuation">(</span>marker<span class="token operator">:</span> Marker<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-when">when</span><span class="token punctuation">(</span>marker<span class="token operator">?</span><span class="token punctuation">.</span>tag<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token string">"hotel"</span> <span class="token operator">-&gt;</span> <span class="token operator">..</span><span class="token operator">..</span>
        <span class="token string">"citie"</span> <span class="token operator">-&gt;</span> <span class="token operator">..</span><span class="token operator">..</span>
        <span class="token string">"myPosition"</span> <span class="token operator">-&gt;</span><span class="token operator">..</span><span class="token punctuation">.</span>

    <span class="token punctuation">}</span>
<span class="token operator">..</span><span class="token operator">..</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
                </section><br><br>

                <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-15-52-17.png"><br><figcaption></figcaption></figure>
                <br>
                <figure><img src="./UD9 Multimedia_files/ud9-2022-01-12-15-52-29.png"><br><figcaption></figcaption></figure>
                <br>
                
            </li>

        </ol>


    <p></p>

    <p>This time you must deliver the complete project folder compressed in <span class="negrita">*.zip</span>  and add the <span class="negrita">*.APK</span> too. 
        (Remember to do a clean Project before). <span class="subrayado">The id of your project must be as always com.xxyyzz.mymaps</span>  (xx, the first two letters of the first name, yy, the first two 
        letters of the first last name, zz the first two letters of the second last name</p>
    
    </div>

    </section><!-- End section -->

    <!--*********************************************************Webgraphy***********************************************************-->
    <section class="apartado">
        <a name="sWebgraphy"></a>
        <h2>Webgraphy</h2>
        
        <ul>
            <li><a class="enlace" target="_blank" href="https://developer.android.com/guide/topics/media/mediaplayer">MediaPlayer</a> </li>

            <li><a class="enlace" target="_blank" href="https://airbnb.design/lottie/">https://airbnb.design/lottie/</a> </li>
            <li><a class="enlace" target="_blank" href="https://lottiefiles.com/">https://lottiefiles.com/</a> </li>
            <li><a class="enlace" target="_blank" href="https://github.com/yuriy-budiyev/code-scanner">code-scanner</a> </li>
            <li>Cefire Android course of Marcos Leiros </li>
    
        </ul>
        
        
        </section><!-- End section -->



    <script src="./UD9 Multimedia_files/prism.js.descarga"></script>



</body></html>